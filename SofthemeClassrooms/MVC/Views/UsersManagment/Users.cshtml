@using WebApplication1.Models;
@using WebApplication1.HtmlHelpers;
@model UsersPageModel

@{
    ViewBag.Title = "Пользователи";
}


<div class="container">
    <div class="col-lg-8 col-lg-offset-1">
        <h2>
            Список пользователей
            @if(Model.SearchPattern != null)
            {
                <span>с именем</span>
                @Model.SearchPattern;
            }
        </h2>
        <div>
            <span>Всего: @Model.Users.Count()</span>
            <div class="searchForm">
                @using (Html.BeginForm("Users", "UsersManagment", FormMethod.Get))
                {
                    <input name='SearcPattern' type='text' value='@Model.SearchPattern' id ='user-search' onkeyup = 'SendChecker()'/>
                    @Html.HiddenFor(m => m.PageInfo.PageNumber)
                    <button id="searchButton" type="submit" onsubmit="ValidateSearchInput" disabled>
                        <i class="fa fa-search" aria-hidden="true"></i>
                    </button>
                }
            </div>
        </div>
        <ul class="userTable">
            @{
                int i = 0;
                foreach (var u in Model.Users)
                {
                    <li>
                        <div class="usersTableRow">
                            <a href="@Url.Action("UserPage", "UsersManagment", u)">

                                <div class="usersTableItem">@u.Name</div>
                                <div class="usersTableItem">@u.Email</div>
                                <div class="usersTableItem"><i class="fa fa-calendar" aria-hidden="true"></i> @u.NumberOfEvents</div>
                            </a>
                            <div class="usersTableItem">
                                <button class="delete" onclick="DeleteUserPopupShow('@i.ToString()')"><i class="fa fa-times" aria-hidden="true"></i></button>
                            </div>

                            @Html.Partial("DeletePersonPopup", new WebApplication1.Models.Pair<System.Int32, System.String>
                       {
                           item1 = i,
                           item2 = u.Id
                       })
                        </div>
                    </li>
                    ++i;
                }
            }
        </ul>
        <div id="pageLinks" class="btn-group">
            @Html.PageLinks(Model.PageInfo, x => Url.Action("Users", new { page = x }))
        </div>
    </div>
</div>



@section MenuItemActive{
    <script>
        ActivateMenu('usersItem');
    </script>

}
